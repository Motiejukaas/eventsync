# EventSync

EventSync is a Spring Boot REST API for managing events and collecting user feedback with AI-powered sentiment analysis and summarization.  
It integrates with **OpenAI** (deprecated) and **Hugging Face** APIs to analyze and summarize event feedback automatically.

The repository also contains a React + Vite frontend in `eventsync-frontend/` which is built and served by nginx in production.

---
## Deployment
Currently available at: https://eventsync-frontend-140350866035.europe-north2.run.app

## Features
- Create, list, and delete events
- Submit feedback to events
- AI-generated sentiment analysis and summaries
- Sentiment breakdown (positive, neutral, negative counts and percentages)
- OpenAPI (Swagger) documentation
- Async event-driven summary generation
- In-memory H2 database
- Dockerized for deployment to Google Cloud Run

---

## Tech Stack

**Backend**
- Java 25
- Spring Boot 3.5
- Spring Data JPA + Hibernate
- Spring Validation
- Springdoc OpenAPI (Swagger UI)
- H2 database


**External APIs**
- [OpenAI API](https://platform.openai.com/docs/) – for feedback summarization (unused)
- [Hugging Face Inference API](https://huggingface.co/docs/api-inference/) – for sentiment classification and feedback summarization

**Build & Deployment**
- Maven
- Docker
- Google Cloud Run
- Google Secret Manager (for API keys)

---

## API Endpoints

### Events

#### Create Event
`POST /events`

Request body:

```json
{
  "title": "Ceramics Workshop",
  "description": "Beginner pottery class on Nov 5th, 18:00."
}
```

#### List All Events

`GET /events`

Returns all events with sentiment counts and summaries.

#### Delete Event

`DELETE /events/{eventId}`

Deletes an event by ID.

#### Submit Feedback

`POST /events/{eventId}/feedback`

Request body:

```json
{
  "message": "Loved the class!"
}
```

Automatically performs sentiment analysis and publishes feedback creation event which may trigger an AI feedbacks summary update.

#### Get Sentiment Breakdown

`GET /events/{eventId}/summary`

Returns sentiment breakdown (positive, neutral, negative counts and percentages).

#### Get AI-Generated Summary

`GET /events/{eventId}/summary/ai`

Returns a summary of event feedbacks generated by an LLM.

### Feedback
#### Get Feedbacks by Event ID

`GET /feedbacks/{eventId}`

Returns all the event's feedbacks.

## Local Development
### Prerequisites

- Java 25
- Maven
- Node.js
- npm
- Docker (optional)

### Environment Variables

These must be set:

OPENAI_API_KEY	OpenAI API key  
HF_TOKEN Hugging Face API token

Backend CORS origin (mapped from Spring property `app.cors.allowed-origin`):

- `APP_CORS_ALLOWED_ORIGIN` — the allowed frontend origin (e.g., `https://example.com`).

Additional notes:
- The frontend build can embed an API endpoint via `VITE_API_URL`. In local Docker Compose it is baked as `http://localhost:8080`. In other deployments (e.g., Cloud Run) set it to the public backend URL.


### Backend development

```powershell
mvn spring-boot:run
```

The app starts on: http://localhost:8080

### Frontend development (Vite)

For local, hot-reload frontend development without Docker:

```powershell
cd eventsync-frontend
npm install
npm run dev
```

The dev server runs on http://localhost:5173 and, by default, the app will call the backend at http://localhost:8080.


## Docker

### Full‑stack (frontend + backend) with Docker Compose (local)

Run both services:

```powershell
docker compose up --build
```

URLs:
- Frontend: http://localhost:5173 (served by nginx)
- Backend API: http://localhost:8080

Notes:
- Frontend uses an absolute API base URL baked at build time via `VITE_API_URL` (see `compose.yaml`).
- For local Docker Compose, `VITE_API_URL` is set to `http://localhost:8080` so the browser calls the backend directly.
- CORS for local dev is set to `http://localhost:5173` via `APP_CORS_ALLOWED_ORIGIN` in `compose.yaml`.

Stop containers:

```powershell
docker compose down
```

### Building images separately

```powershell
# Backend
docker build -t eventsync-server .

# Frontend (production build)
docker build -t eventsync-frontend ./eventsync-frontend
```

## Swagger

Access Swagger UI
http://localhost:8080/swagger-ui/index.html

Once deployed, Swagger UI is not accessible due to disabled CORS.

## Development Notes

H2 DB is configured in-memory
It resets each time the app restarts.

For persistent storage, replace with a real database (e.g. PostgreSQL).